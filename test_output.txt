============================= test session starts =============================
platform win32 -- Python 3.9.0, pytest-7.4.4, pluggy-1.6.0 -- C:\Users\facu-\AppData\Local\Programs\Python\Python39\python.exe
cachedir: .pytest_cache
rootdir: E:\Backup pc de escritorio\Nomos\Nomos-Excel-Service
configfile: pytest.ini
plugins: anyio-4.12.1, asyncio-0.23.3, cov-4.1.0
asyncio: mode=auto
collecting ... Windows fatal exception: code 0xc0000139

Current thread 0x00003e58 (most recent call first):
  File "<frozen importlib._bootstrap>", line 228 in _call_with_frames_removed
  File "<frozen importlib._bootstrap_external>", line 1108 in create_module
  File "<frozen importlib._bootstrap>", line 565 in module_from_spec
  File "<frozen importlib._bootstrap>", line 666 in _load_unlocked
  File "<frozen importlib._bootstrap>", line 986 in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 1007 in _find_and_load
  File "C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\cryptography\exceptions.py", line 9 in <module>
  File "<frozen importlib._bootstrap>", line 228 in _call_with_frames_removed
  File "<frozen importlib._bootstrap_external>", line 790 in exec_module
  File "<frozen importlib._bootstrap>", line 680 in _load_unlocked
  File "<frozen importlib._bootstrap>", line 986 in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 1007 in _find_and_load
  File "C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\cryptography\hazmat\primitives\asymmetric\ec.py", line 11 in <module>
  File "<frozen importlib._bootstrap>", line 228 in _call_with_frames_removed
  File "<frozen importlib._bootstrap_external>", line 790 in exec_module
  File "<frozen importlib._bootstrap>", line 680 in _load_unlocked
  File "<frozen importlib._bootstrap>", line 986 in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 1007 in _find_and_load
  File "C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\jwt\utils.py", line 7 in <module>
  File "<frozen importlib._bootstrap>", line 228 in _call_with_frames_removed
  File "<frozen importlib._bootstrap_external>", line 790 in exec_module
  File "<frozen importlib._bootstrap>", line 680 in _load_unlocked
  File "<frozen importlib._bootstrap>", line 986 in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 1007 in _find_and_load
  File "C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\jwt\algorithms.py", line 21 in <module>
  File "<frozen importlib._bootstrap>", line 228 in _call_with_frames_removed
  File "<frozen importlib._bootstrap_external>", line 790 in exec_module
  File "<frozen importlib._bootstrap>", line 680 in _load_unlocked
  File "<frozen importlib._bootstrap>", line 986 in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 1007 in _find_and_load
  File "C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\jwt\api_jwk.py", line 8 in <module>
  File "<frozen importlib._bootstrap>", line 228 in _call_with_frames_removed
  File "<frozen importlib._bootstrap_external>", line 790 in exec_module
  File "<frozen importlib._bootstrap>", line 680 in _load_unlocked
  File "<frozen importlib._bootstrap>", line 986 in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 1007 in _find_and_load
  File "C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\jwt\__init__.py", line 1 in <module>
  File "<frozen importlib._bootstrap>", line 228 in _call_with_frames_removed
  File "<frozen importlib._bootstrap_external>", line 790 in exec_module
  File "<frozen importlib._bootstrap>", line 680 in _load_unlocked
  File "<frozen importlib._bootstrap>", line 986 in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 1007 in _find_and_load
  File "C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\gotrue\_async\gotrue_client.py", line 11 in <module>
  File "<frozen importlib._bootstrap>", line 228 in _call_with_frames_removed
  File "<frozen importlib._bootstrap_external>", line 790 in exec_module
  File "<frozen importlib._bootstrap>", line 680 in _load_unlocked
  File "<frozen importlib._bootstrap>", line 986 in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 1007 in _find_and_load
  File "C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\gotrue\__init__.py", line 7 in <module>
  File "<frozen importlib._bootstrap>", line 228 in _call_with_frames_removed
  File "<frozen importlib._bootstrap_external>", line 790 in exec_module
  File "<frozen importlib._bootstrap>", line 680 in _load_unlocked
  File "<frozen importlib._bootstrap>", line 986 in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 1007 in _find_and_load
  File "<frozen importlib._bootstrap>", line 228 in _call_with_frames_removed
  File "<frozen importlib._bootstrap>", line 972 in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 1007 in _find_and_load
  File "C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\supabase\__init__.py", line 1 in <module>
  File "<frozen importlib._bootstrap>", line 228 in _call_with_frames_removed
  File "<frozen importlib._bootstrap_external>", line 790 in exec_module
  File "<frozen importlib._bootstrap>", line 680 in _load_unlocked
  File "<frozen importlib._bootstrap>", line 986 in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 1007 in _find_and_load
  File "E:\Backup pc de escritorio\Nomos\Nomos-Excel-Service\app\services\supabase_client.py", line 1 in <module>
  File "<frozen importlib._bootstrap>", line 228 in _call_with_frames_removed
  File "<frozen importlib._bootstrap_external>", line 790 in exec_module
  File "<frozen importlib._bootstrap>", line 680 in _load_unlocked
  File "<frozen importlib._bootstrap>", line 986 in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 1007 in _find_and_load
  File "E:\Backup pc de escritorio\Nomos\Nomos-Excel-Service\app\services\__init__.py", line 2 in <module>
  File "<frozen importlib._bootstrap>", line 228 in _call_with_frames_removed
  File "<frozen importlib._bootstrap_external>", line 790 in exec_module
  File "<frozen importlib._bootstrap>", line 680 in _load_unlocked
  File "<frozen importlib._bootstrap>", line 986 in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 1007 in _find_and_load
  File "<frozen importlib._bootstrap>", line 228 in _call_with_frames_removed
  File "<frozen importlib._bootstrap>", line 972 in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 1007 in _find_and_load
  File "E:\Backup pc de escritorio\Nomos\Nomos-Excel-Service\tests\test_excel_processor.py", line 4 in <module>
  File "C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\_pytest\assertion\rewrite.py", line 186 in exec_module
  File "<frozen importlib._bootstrap>", line 680 in _load_unlocked
  File "<frozen importlib._bootstrap>", line 986 in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 1007 in _find_and_load
  File "<frozen importlib._bootstrap>", line 1030 in _gcd_import
  File "C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\importlib\__init__.py", line 127 in import_module
  File "C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\_pytest\pathlib.py", line 567 in import_path
  File "C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\_pytest\python.py", line 617 in _importtestmodule
  File "C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\_pytest\python.py", line 528 in _getobj
  File "C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\_pytest\python.py", line 310 in obj
  File "C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\pytest_asyncio\plugin.py", line 620 in _patched_collect
  File "C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\_pytest\runner.py", line 372 in <lambda>
  File "C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\_pytest\runner.py", line 341 in from_call
  File "C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\_pytest\runner.py", line 372 in pytest_make_collect_report
  File "C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\pluggy\_callers.py", line 121 in _multicall
  File "C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\pluggy\_manager.py", line 120 in _hookexec
  File "C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\pluggy\_hooks.py", line 512 in __call__
  File "C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\_pytest\runner.py", line 547 in collect_one_node
  File "C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\_pytest\main.py", line 842 in genitems
  File "C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\_pytest\main.py", line 675 in perform_collect
  File "C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\_pytest\main.py", line 335 in pytest_collection
  ...
collected 0 items / 2 errors

=================================== ERRORS ====================================
_______________ ERROR collecting tests/test_excel_processor.py ________________
ImportError while importing test module 'E:\Backup pc de escritorio\Nomos\Nomos-Excel-Service\tests\test_excel_processor.py'.
Hint: make sure your test modules/packages have valid Python names.
Traceback:
C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\_pytest\python.py:617: in _importtestmodule
    mod = import_path(self.path, mode=importmode, root=self.config.rootpath)
C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\_pytest\pathlib.py:567: in import_path
    importlib.import_module(module_name)
C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\importlib\__init__.py:127: in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
<frozen importlib._bootstrap>:1030: in _gcd_import
    ???
<frozen importlib._bootstrap>:1007: in _find_and_load
    ???
<frozen importlib._bootstrap>:986: in _find_and_load_unlocked
    ???
<frozen importlib._bootstrap>:680: in _load_unlocked
    ???
C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\_pytest\assertion\rewrite.py:186: in exec_module
    exec(co, module.__dict__)
tests\test_excel_processor.py:4: in <module>
    from app.services.excel_processor import ExcelProcessor
app\services\__init__.py:2: in <module>
    from app.services.supabase_client import SupabaseClient
app\services\supabase_client.py:1: in <module>
    from supabase import create_client, Client
C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\supabase\__init__.py:1: in <module>
    from gotrue.errors import (
C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\gotrue\__init__.py:7: in <module>
    from ._async.gotrue_client import AsyncGoTrueClient  # type: ignore # noqa: F401
C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\gotrue\_async\gotrue_client.py:11: in <module>
    from jwt import get_algorithm_by_name
C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\jwt\__init__.py:1: in <module>
    from .api_jwk import PyJWK, PyJWKSet
C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\jwt\api_jwk.py:8: in <module>
    from .algorithms import get_default_algorithms, has_crypto, requires_cryptography
C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\jwt\algorithms.py:21: in <module>
    from .utils import (
C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\jwt\utils.py:7: in <module>
    from cryptography.hazmat.primitives.asymmetric.ec import EllipticCurve
C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\cryptography\hazmat\primitives\asymmetric\ec.py:11: in <module>
    from cryptography.exceptions import UnsupportedAlgorithm, _Reasons
C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\cryptography\exceptions.py:9: in <module>
    from cryptography.hazmat.bindings._rust import exceptions as rust_exceptions
E   ImportError: DLL load failed while importing _rust: No se encontró el proceso especificado.
____________________ ERROR collecting tests/test_routes.py ____________________
tests\test_routes.py:3: in <module>
    from app.main import app
app\main.py:3: in <module>
    from app.config import settings
app\config.py:43: in <module>
    settings = Settings()
C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\pydantic_settings\main.py:71: in __init__
    super().__init__(
E   pydantic_core._pydantic_core.ValidationError: 2 validation errors for Settings
E   supabase_url
E     Field required [type=missing, input_value={}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.6/v/missing
E   supabase_key
E     Field required [type=missing, input_value={}, input_type=dict]
E       For further information visit https://errors.pydantic.dev/2.6/v/missing
============================== warnings summary ===============================
tests\test_excel_processor.py:2
  E:\Backup pc de escritorio\Nomos\Nomos-Excel-Service\tests\test_excel_processor.py:2: DeprecationWarning: 
  Pyarrow will become a required dependency of pandas in the next major release of pandas (pandas 3.0),
  (to allow more performant data types, such as the Arrow string type, and better interoperability with other libraries)
  but was not found to be installed on your system.
  If this would cause problems for you,
  please provide us feedback at https://github.com/pandas-dev/pandas/issues/54466
          
    import pandas as pd

C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\supabase\__init__.py:1
  C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\supabase\__init__.py:1: DeprecationWarning: The `gotrue` package is deprecated, is not going to receive updates in the future. Please, use `supabase_auth` instead.
    from gotrue.errors import (

C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\pydantic\_internal\_config.py:272
  C:\Users\facu-\AppData\Local\Programs\Python\Python39\lib\site-packages\pydantic\_internal\_config.py:272: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.6/migration/
    warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html

----------- coverage: platform win32, python 3.9.0-final-0 -----------
Name                                 Stmts   Miss  Cover   Missing
------------------------------------------------------------------
app\__init__.py                          1      0   100%
app\config.py                           23      2    91%   35, 40
app\contracts\__init__.py                3      3     0%   2-5
app\contracts\database_client.py         6      6     0%   2-32
app\contracts\excel_processor.py         7      7     0%   2-33
app\factories\__init__.py                2      2     0%   2-4
app\factories\service_factory.py         6      6     0%   2-13
app\infrastructure\__init__.py           2      2     0%   2-4
app\infrastructure\data_storage.py      38     38     0%   2-114
app\main.py                             17     14    18%   4-46
app\models\__init__.py                   3      3     0%   1-9
app\models\excel.py                     72     72     0%   1-130
app\models\response.py                  23     23     0%   1-35
app\routes\__init__.py                   2      2     0%   1-3
app\routes\excel.py                     87     87     0%   1-266
app\services\__init__.py                 3      1    67%   4
app\services\excel_processor.py        149    124    17%   15, 19-35, 39-73, 85-119, 126-137, 142-157, 162-173, 177-179, 183-192, 196, 211-245, 254-265, 290-377, 391-404
app\services\supabase_client.py         45     44     2%   2-121
app\utils\__init__.py                    3      3     0%   1-4
app\utils\helpers.py                    16     16     0%   1-30
app\utils\validators.py                 10     10     0%   1-30
------------------------------------------------------------------
TOTAL                                  518    465    10%
Coverage HTML written to dir htmlcov

=========================== short test summary info ===========================
ERROR tests/test_excel_processor.py
ERROR tests/test_routes.py - pydantic_core._pydantic_core.ValidationError: 2 ...
!!!!!!!!!!!!!!!!!!! Interrupted: 2 errors during collection !!!!!!!!!!!!!!!!!!!
======================== 3 warnings, 2 errors in 4.23s ========================
